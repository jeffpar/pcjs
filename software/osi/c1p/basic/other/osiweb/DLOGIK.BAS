 5  POKE 61440,81:CLG1: POKE 61440,17:PAGE
 10  POKE 8*16+6,8*16: CLEAR 
 15  DIM A(100),D(100),Q(100),S$(10),S(10)
 20  DIM M(2,10),H(100),F(100),Z(100),J(10),R(10),W(10)
 30  DIM R1(10),A5$(30),D5$(2)
 40  REM   ******START******
 50  PRINT "WIEVIELE EING.VARIABLEN D";: INPUT D1
 60  PRINT  "WIEVIELE D,A,Q DRUCKEN?": INPUT D0,A2,Q0
 65  IF D0+A2+Q0>13 THEN  PRINT "Zu grosser Ausgabebereich": PRINT : GOTO 60
 70  PRINT "IMPULSD. ODER WAHRH.TAB.?";: INPUT  A$
 80  PRINT : PRINT "EINGABE DES SCHALTPLANS!"
 90 I0=I0+1
 100  INPUT  S$(I0)
 110  FOR I=1 TO  LEN (S$(I0))
 112  IF  MID$ (S$(I0),I,1)="*" THEN 130
 114  NEXT I
 120  GOTO 90
 130  FOR I=1 TO 100
 140 A(I)=76:D(I)=76:Q(I)=76:H(I)=76:Z(I)=76:F(I)=76
 150  NEXT I
 160  FOR I=1 TO 10
 170 S(I)=76:J(I)=0:R(I)=0
 180  NEXT I:PAGE:SCR0,30,"VORGABE ZUR WAHR.TABELLE"
 200  GOTO 1250
 230 S0=0:F0=0:J0=0:Z9=1:I9=1
 240  REM  ** SUCHEN **
 250  IF  MID$ (S$(Z9),I9,1)="*" THEN 1180
 260  IF  MID$ (S$(Z9),I9,1)="$" THEN 300
 270 W9=1
 280  GOSUB 9000
 290  GOTO 240
 300 K0=0: FOR I=1 TO 10:W(I)=0: NEXT I
 310  IF  MID$ (S$(Z9),I9,1)="/" THEN 480
 320 W9=1: GOSUB 9000
 330 F$= MID$ (S$(Z9),I9,1)
 340 W9=1: GOSUB 9000
 350  IF F$="P" THEN 370
 360 F9= VAL ( MID$ (S$(Z9),I9,2))
 370 K0=K0+1
 380  IF F$="D" THEN 420
 390  IF F$="A" THEN 440
 400  IF F$="P" THEN 460
 410  PRINT "INPUT ERROR 1": STOP 
 420 W(K0)=D(F9):W9=2: GOSUB 9000
 430  GOTO 310
 440 W(K0)=A(F9):W9=2: GOSUB 9000
 450  GOTO 310
 460 W(K0)= ASC ( MID$ (S$(Z9),I9,1)):W9=1: GOSUB 9000
 470  GOTO 310
 480 W9=1: GOSUB 9000
 490 G1$="-1"
 500 G$= MID$ (S$(Z9),I9,1):W9=1: GOSUB 9000
 510  IF  MID$ (S$(Z9),I9,1)="/" THEN 530
 520 G1$= MID$ (S$(Z9),I9,1):W9=1: GOSUB 9000
 530 W9=1: GOSUB 9000
 540 F$= MID$ (S$(Z9),I9,1)
 550 W9=1: GOSUB 9000
 560 F9= VAL ( MID$ (S$(Z9),I9,2))
 570  IF F$="A" THEN 600
 580  IF F$="Q" THEN 610
 590  PRINT  "INPUT ERROR 2": STOP 
 600 O=A(F9): GOTO 620
 610 O=Q(F9)
 620  IF G$<>"R" THEN 730
 630 S0=S0+1
 640  IF R(S0)=0 THEN 680
 650 O1=S(S0)
 660 R1(S0)=0
 670  GOTO 1130
 680 F=S(S0)
 690 S(S0)=W(1)
 700  IF F=S(S0) THEN 720
 710 R1(S0)=1
 720  GOTO 240
 730 A1=A0:O1=O
 740  IF G$<>"S" THEN 770
 750 I1=1: GOSUB 2000
 760  GOTO 1120
 770  IF G$="F" THEN 800
 780  IF G$="L" THEN 800
 790  GOTO 820
 800  GOSUB 3000
 810  GOTO 1120
 820  IF G$="J" THEN 850
 830  IF G$="M" THEN 850
 840  GOTO 870
 850  GOSUB 4000
 860  GOTO 1120
 870  IF G$<>"U" THEN 960
 880 O1=72
 890  FOR I=1 TO K0
 900  IF W(I)=72 THEN 920
 910 O1=76
 920  NEXT I
 930  IF O1=O THEN 950
 940 A1=1
 950  GOTO 1050
 960  IF G$<>"O" THEN 1040
 970 O1=76
 980  FOR I=1 TO K0
 990  IF W(I)=76 THEN 1010
 1000 O1=72
 1010  NEXT I
 1020  IF O1=O THEN 1040
 1030 A1=1
 1040  IF G$="N" THEN 1070
 1050  IF G1$<>"N" THEN 1120
 1060 A1=A0:W(1)=O1
 1070  IF W(1)=72 THEN 1090
 1080 O1=72: GOTO 1100
 1090 O1=76
 1100  IF O1=O THEN 1120
 1110 A1=1
 1120 A0=A1
 1130 O=O1
 1140  IF F$="A" THEN 1160
 1150 Q(F9)=O: GOTO 1170
 1160 A(F9)=O
 1170  GOTO 240
 1180  IF A0=0 THEN 1210
 1190 A0=0
 1200  GOTO 230
 1210  GOSUB 5000
 1220 Z8=1
 1230  FOR I=1 TO 100:F(I)=Z(I): NEXT I
 1240  FOR I=1 TO 10:J(I)=0:R(I)=R1(I): NEXT I
 1245  IF  LEN (E$)>D1 THEN E$= RIGHT$ (E$, LEN (E$)-D1): GOTO 1260
 1250  IF A$="W" THEN 1259
 1252 SCR0,31,"EINGABE DER EINGANGSVARIABLEN :"
 1259  INPUT E$
 1260  FOR I=1 TO D1
 1270 D(I)= ASC ( MID$ (E$,I,1))
 1280  IF D(1)=69 THEN 9900
 1290  NEXT I
 1300  GOTO 230
 1310  REM  ** ENDE DES HA.PROGR.**
 1320  STOP 
 2000  REM  ** SR-FLIP-FLOP **
 2010 F0=F0+2
 2020  IF F(F0)=76 THEN 2050
 2030  IF W(I1+1)<>76 THEN 2050
 2040 O1=72:N=1: GOTO 2080
 2050  IF F(F0-1)=76 THEN 2080
 2060  IF W(I1)<>76 THEN 2080
 2070 O1=76:N=1
 2080 Z(F0)=W(I1+1):Z(F0-1)=W(I1)
 2090  IF O1=O THEN 2110
 2100 A1=1
 2110  RETURN 
 3000  REM  ** D-FLIP-FLOP **
 3010 N=0:S=0
 3020  IF G$="F" THEN 3040
 3025  IF G1$="+" THEN 3030
 3027 S=76: GOTO 3050
 3030 S=72
 3040  IF G1$="+" THEN 3060
 3050 U=76: GOTO 3070
 3060 U=72
 3070 F0=F0+2:F1=F0-1
 3080  IF H(F1)=1 THEN 3110
 3090 F(F1)=U
 3100 H(F1)=1
 3110  IF W(3)<>0 THEN 3170
 3120  IF W(2)=S THEN 3160
 3130  IF F(F1)=U THEN 3220
 3140  IF W(2)<>U THEN 3220
 3150 O1=F(F1+1): GOTO 3220
 3160 O1=W(1): GOTO 3220
 3170 I1=3
 3180  IF W(4)<>0 THEN 3200
 3190 W(4)=72 
 3200  GOSUB 2000
 3210  IF N=0 THEN 3120
 3220 Z(F1)=W(2):Z(F1+1)=W(1)
 3230  IF O1=O THEN 3250
 3240 A1=1
 3250  RETURN 
 4000  REM  ** JK-FLIP-FLOP **
 4010 J0=J0+1:N=0
 4020  IF G1$="+" THEN 4040
 4030 U=76: GOTO 4050
 4040 U=72
 4050 F0=F0+3
 4060 F1=F0
 4070  IF H(F1)=1 THEN 4090
 4080 H(F1)=1:M(1,J0)=W(1):M(2,J0)=W(2):F=U
 4090  IF W(4)<>0 THEN 4290
 4100  IF G$<>"M" THEN 4140
 4110  IF F(F1)<>U THEN 4160
 4120  IF W(3)=U THEN 4160
 4130 M(1,J0)=W(1):M(2,J0)=W(2): GOTO 4320
 4140 M(1,J0)=W(1)
 4150 M(2,J0)=W(2)
 4160  IF F(F1)=U THEN 4320
 4170  IF W(3)<>U THEN 4320
 4180  IF M(1,J0)<>76 THEN 4200
 4190  IF M(2,J0)=76 THEN 4320
 4200  IF M(1,J0)=76 THEN 4220
 4210  IF M(2,J0)<>76 THEN 4230
 4220 O1=M(1,J0): GOTO 4320
 4230  IF O1=72 THEN 4250
 4240 O2=72: GOTO 4260
 4250 O2=76
 4260  IF J(J0)<>0 THEN 4280
 4270 J(J0)=O2
 4280 O1=J(J0): GOTO 4320
 4290 I1=4: IF W(5)<>0 THEN 4305
 4300 W(5)=72: GOSUB 2000
 4305  GOSUB 2000
 4310  IF N=0 THEN 4100
 4315 Z(F1)=W(3):Z(F1-1)=W(1):Z(F1-2)=W(2)
 4320 Z(F1)=W(3):Z(F1-1)=W(1):Z(F1-2)=W(2)
 4330  IF O1=O THEN 4350
 4340 A1=1
 4350  RETURN 
 5000  REM  **AUSDRUCK**
 5010  IF Z8=1 THEN 5310
 5020 PAGE: PRINT "SIMULATIONSERGEBNISS"
 5030  FOR I=1 TO 30: PRINT "=";: NEXT I: PRINT : PRINT 
 5050  PRINT "ALS  ";
 5060  IF A$="I" THEN 5080
 5070  PRINT "WAHRHEITSTABELLE": PRINT : GOTO 5090
 5080  PRINT "INPULSDIAGRAMM": PRINT 
 5090  PRINT "SCHALTPLANLOGIK:"
 5100 I9=1:Z9=1
 5110  PRINT  MID$ (S$(Z9),I9,1);
 5120 W9=1: GOSUB 9000
 5130 F8$= MID$ (S$(Z9),I9,1)
 5140  IF F8$="$" THEN 5170
 5150  IF F8$="*" THEN 5180
 5160  GOTO 5110
 5170  PRINT : GOTO 5110
 5180  PRINT : PRINT "Press any key":CALL64768,0
 5185  IF A$="I" THEN 7180
 5190  PRINT : PRINT : PRINT 
 5200  FOR I=1 TO D0: PRINT "D";: IF I>9 THEN 5220
 5210  PRINT " ";
 5220  PRINT I;"*";: NEXT I
 5225  IF A2=0 THEN 5255
 5230  FOR I=1 TO A2: PRINT "A";: IF I>9 THEN 5250
 5240  PRINT " ";
 5250  PRINT I;"*";: NEXT I
 5255  IF Q0=0 THEN 5290
 5260  FOR I=1 TO Q0: PRINT "Q";: IF I>9 THEN 5280
 5270  PRINT " ";
 5280  PRINT I;"*";: NEXT I
 5290  PRINT 
 5300  FOR I=1 TO D0+Q0+A2: PRINT "------";: NEXT I
 5310  PRINT 
 5320  FOR I=1 TO D0+A2+Q0
 5330  IF I>D0 THEN 5350
 5340 A5$(I)= CHR$ (D(I))
 5350  IF I<=D0 THEN 5380
 5360  IF I>A2+D0 THEN 5380
 5370 A5$(I)= CHR$ (A(I-D0))
 5380  IF I<=A2+D0 THEN 5400
 5390 A5$(I)= CHR$ (Q(I-A2-D0))
 5400  NEXT I
 5410  IF A$="I" THEN 5460
 5420  FOR I=1 TO D0+A2+Q0
 5430  PRINT A5$(I);"    *";
 5440  NEXT I
 5450  RETURN 
 5460  FOR I=1 TO D0+Q0+A2
 5500  IF A5$(I)="H" THEN SCRZW,29-(16-I)*2, CHR$ (161),"    ": GOTO 5520
 5510 SCRZW,29-(16-I)*2, CHR$ (128),"    "
 5520  NEXT I
 5530 ZW=ZW+1
 5540  IF ZW=31 THEN ZW=4:CALL64768,0
 5550  RETURN 
 7180 PAGE:ZW=4
 7185  IF D0=0 THEN 7225
 7200  FOR I=1 TO D0: PRINT "D";: IF I>9 THEN 7220
 7220  PRINT I: PRINT : NEXT 
 7225  IF A2=0 THEN 7255
 7230  FOR I=1 TO A2: PRINT "A";: IF I>9 THEN 7250
 7250  PRINT I: PRINT : NEXT I
 7255  IF Q0=0 THEN 7290
 7260  FOR I=1 TO Q0: PRINT "Q";: IF I>9 THEN 7280
 7280  PRINT I: PRINT : NEXT I
 7290  GOTO 5320
 9000  FOR I=1 TO W9
 9010  IF I9>= LEN (S$(Z9)) THEN 9040
 9020 I9=I9+1
 9030  GOTO 9050
 9040 I9=1:Z9=Z9+1
 9050  NEXT I
 9060  RETURN 
 9900  PRINT : PRINT : PRINT 
 9999  RETURN
