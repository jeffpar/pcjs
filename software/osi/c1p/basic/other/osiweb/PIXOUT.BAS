10POKE558,185:POKE559,248:POKE133,0:POKE134,64:CLEAR
40DIMD(1),DY,UY,FA,AD,ZZ:INPUT"BLOECKEVONBIS";BL,BH
45INPUT"BLOCKNAME,LAUF.NR.";OS$,LN
50INPUT"ANZEIGEBEREICH";XM,YM:IFXM>1023ORYM>767THEN50
53INPUT"PAPIERFOR.(3/4),STIFTDICK.(mm)";PF,SD:SD=SD*1.05
55OUT0,16384,31:OUT1,"IN;OE;PS",PF,";SP1;"
60NM=(XM+1)*(YM+1)/8-1:ZZ=0:PU=.025
65S=576:FORZW=STOS+71:READZK:POKEZW,ZK:NEXT:D(0)=-99:D(1)=99
70NZ=(XM+1)/8-1:P1=10800:P2=6800:IFPF=3THENP1=15200:P2=10800
75OUT1,"IP",0,0,P1,P2
76INPUT"BILDFOR.(X:Y),POS.(<10),OK(0)";BX,BY,PX,PY,Y:IFYTHEN40
77ZE=YM:FA=BY/BX
78YM=YM*BY:XM=XM*BX:YO=P2*PU/SD:IFYO<YMTHENFA=YM/YO:YO=YM
79XO=P1*PU/SD:IFXO<XMTHENFA=FA*XM/XO:YO=XM/XO:XO=XM
80IFYM+PY*YO/10>YOTHEN40
81IFXM+PX*XO/10>XOTHEN40
82OUT1,"SC",-PX,10-PX,-PY*YO/10,(10-PY)*YO/10:SELLN:IFERRTHENSTOP
85FORB=BLTOBH:ZK=0:O$=OS$
90O$=O$+CHR$(B+48):OLDO$
100FORY=1TOINT(8192/(NZ+1)):AD=(NZ+1)*ZK+6*4096:GOSUB500
130ZZ=ZZ+1:ZK=ZK+1:IFZZ>ZETHEN150
140NEXT:NEXT
150OUT1,"IN;":FOR
500OUT1,";OE;PA0,",ZZ,";UC":POKE246,1:POKE245,NZ+1:POKE244,0
510UY=0:ZW=INT(AD/256):POKE241,ZW:POKE240,AD-256*ZW
520POKE243,8:ZW=PEEK(AD):POKE242,ZW
530ON(CALLS,ZW)GOTO540,550
540DY=PEEK(247)/FA:UY=UY+DY-INT(DY):IFUY>1THENUY=UY-1:DY=DY+1
545OUT1,D(PEEK(246)),INT(DY),0:IFPEEK(247)<98THEN530
547ZW=ABS(PEEK(246)-1):POKE246,ZW:GOTO530
550OUT1,D(PEEK(246)),INT((1+PEEK(247))/FA),0:RETURN
1000DATA165,246,73,1,133,246,169,0,133,247,165,242,164,244,166
1010DATA243,230,247,10,133,242,144,6,165,246,240,21,208,4,165
1020DATA246,208,15,165,247,201,98,176,9,32,112,2,201,2,208,220,240
1030DATA12,202,208,16,200,132,244,196,245,144,3,169,2,96,177,240
1040DATA133,242,162,8,134,243,169,1,96
22852READ
